<div class="wrap">
  <div class="basicHero">
    <h1>Create Local Database from AACT Snapshots</h1>
  </div>
</div>

<section class="snapshots">
<div class="wrap">

  <p>If you would like to work with the full dataset on your own machine, install PostgreSQL locally, download an AACT database snapshot, and populate a local PostgreSQL database instance with it.</p>

  <%= render 'install_postgres' %>

  <div class="step">
    <span class="stepNumber">2</span>
    <h3 class="stepName">Download an AACT Database Snapshot</h3>
  </div>

  <p>
    Most recent: <a href="<%= @most_recent[:url] %>"><%= @most_recent[:last_modified] %></a> (<%= @most_recent[:size] %>)
  </p>

  <p>
    <%= render 'file_archive' %>
  </p>

  <div class="step">
    <span class="stepNumber">3</span>
    <h3 class="stepName">Populate Local PostgreSQL Database from Snapshot</h3>
  </div>

  <p>Once PostgreSQL is installed on your local machine and you have a snapshot of the AACT database, you can create and populate your own database via a terminal session using the following commands.</p>

  <p class='CodeRay'>
    <p>You'll need to create a root database in your local PostgreSQL instance if one doesn't yet exist. From a terminal session, enter the following command to seed your local PostgreSQL with a database named 'postgres'...</p>
    <pre>
      <p class='code'>
        <span class='command-prompt'>-&gt; </span><span class='command-entry'> createdb postgres</i></span> <span class='command-prompt'></span>
      </p>
    </pre>
  </p>

  <p class='CodeRay'>
    <p>Enter the following command to create the AACT database from the snapshot you've downloaded. From a terminal session, enter the following command...</p>
    <pre>
      <p class='code'>
        <span class='command-prompt'>-&gt; </span><span class='command-entry'> pg_restore -e -v -O -x --dbname=postgres</i> --no-owner --create  <i>&lt;snapshot-filename&gt;</i></span>
      </p>
    </pre>
  </p>

  <p class="note">Note: this restore can take several hours, depending on the speed of your machine.</p>

  <%= render 'download_database_errors' %>

</div>
</section>
